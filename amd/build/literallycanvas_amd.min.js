define(["jquery","core/log","filter_poodll/utils_amd","filter_poodll/react_amd","filter_poodll/literallycanvas"],function(a,b,c,d,e){"use strict";return b.debug("Filter PoodLL: literallycanvas.js initialising"),{loadliterallycanvas:function(b){var d=a("#amdopts_"+b.recorderid).get(0);d&&(b=JSON.parse(d.value)),c.whiteboardopts[b.recorderid]=b;var f=a("#"+b.recorderid+"_literally")[0];if(b.backgroundimage){var g=a("#"+b.recorderid+"_separate-background-image")[0],h=new Image;h.src=g.src,h.crossOrigin="Anonymous";var i=e.createShape("Image",{x:0,y:0,image:h,scale:1}),j=e.init(f,{imageURLPrefix:b.imageurlprefix,backgroundColor:b.backgroundcolor,backgroundShapes:[i],recorderid:b.recorderid})}else var j=e.init(f,{imageURLPrefix:b.imageurlprefix,backgroundColor:b.backgroundcolor,recorderid:b.recorderid});var k=c.whiteboardopts[b.recorderid].vectordata;k&&(0==k.indexOf('{"shapes"')||0==k.indexOf('{"colors"'))&&j.loadSnapshot(JSON.parse(k)),b.autosave?j.on("drawingChange",function(b,d){return function(){var b=a("#"+d+"_messages")[0],e=a("#"+d+"_btn_upload_whiteboard")[0];if(b){e&&(e.disabled=!1),b.innerHTML="";var f=c.timeouthandles[d];f&&clearTimeout(f),c.timeouthandles[d]=setTimeout(function(){c.WhiteboardUploadHandler(d)},c.whiteboardopts[d].autosave)}}}(this,b.recorderid)):j.on("drawingChange",function(b,c){return function(){var b=a("#"+c+"_messages");b&&(b.innerHTML="File has not been saved.")}}(this,b.recorderid)),c.whiteboards[b.recorderid]=j;var l="#"+b.recorderid+"_btn_upload_whiteboard",m=a(l);m&&(b.autosave?m.click(function(){c.WhiteboardUploadHandler(b.recorderid)},!1):m.click(function(){c.CallFileUpload(b.recorderid)},!1))}}});