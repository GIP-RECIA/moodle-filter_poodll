define(["jquery","core/log","filter_poodll/utils_amd","filter_poodll/drawingboard"],function(a,b,c,d){"use strict";return b.debug("Filter PoodLL: drawingboard.js initialising"),{loaddrawingboard:function(a,b){if(c.whiteboardopts[b.recorderid]=b,b.bgimage)var d="transparent";else{var d="background";b.bgimage="#FFF"}var e=new DrawingBoard.Board(b.recorderid+"_drawing-board-id",{recorderid:b.recorderid,size:3,background:b.bgimage,controls:["Color",{Size:{type:"auto"}},{DrawingMode:{filler:!1,eraser:!0,pencil:!0}},"Navigation"],droppable:!0,webStorage:!1,enlargeYourContainer:!0,eraserColor:d});c.whiteboards[b.recorderid]=e;var f=b.vectordata;f&&0!=f.indexOf('{"shapes"')&&(e.history=a.JSON.parse(f),e.setImg(e.history.values[e.history.position-1])),b.autosave?(e.ev.bind("board:startDrawing",function(a,b){return function(){var a=document.getElementById(b+"_messages");if(a){a.innerHTML="File has not been saved.";var d=document.getElementById(b+"_btn_upload_whiteboard");d.disabled=!1;var e=c.timeouthandles[b];e&&clearTimeout(e)}}}(this,b.recorderid)),e.ev.bind("board:stopDrawing",function(a,b){return function(){var a=document.getElementById(b+"_messages");if(a){var d=c.timeouthandles[b];d&&clearTimeout(d),c.timeouthandles[b]=setTimeout(function(){c.WhiteboardUploadHandler(b)},c.whiteboardopts[b].autosave)}}}(this,b.recorderid))):e.ev.bind("board:stopDrawing",function(a,b){return function(){var a=document.getElementById(b+"_messages");a&&(a.innerHTML="File has not been saved.")}}(this,b.recorderid));var g=c.getbyid(b.recorderid+"_btn_upload_whiteboard");g&&(b.autosave?g.addEventListener("click",function(){c.WhiteboardUploadHandler(b.recorderid)},!1):g.addEventListener("click",function(){c.CallFileUpload(b.recorderid)},!1))}}});